<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="pt-BR">
	<head>
		<title>Exemplo - Ajax Upload</title>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
		<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.3/jquery.min.js"></script>
		<script type="text/javascript" src="../upload.js"></script>
		<style type="text/css">
			*{ margin:0; padding:0; list-style:none }
			body{
				font:normal 12px Arial;
			}
			
			input{ margin-top:20px }
			
			#site{ padding:20px }
			.image{ margin:20px }
			img{ width:400px }
		</style>

	</head>
	<body>
	
		<div id="site">

			<h1>Exemplo - Ajax Upload</h1>
			<p>
				<strong>Obs:</strong> A resposta do ajax não é um JSON é uma view, um html, já que a resposta será retornada para um iframe.
			</p>

			<form id="formulario" action="ajax.htm">
				<input type="hidden" name="nome" value="Eduardo" />
				<input type="hidden" name="sobrenome" value="Ottaviani" />
				<input type="file" id="file" name="imagem" />
				<div class="image"><img src="" id="preview" alt="Preview" /></div>
			</form>

			<script type="text/javascript">
				
				var form = $('#formulario');
				var action = form.attr('action');
				var preview = $('#preview');

				var upload = new Upload._class({
					form :form,
					callback :function(response){
						preview.attr('src', response.url);		
					}
				});
				
				form.find('input:file').change(function(){
					upload.send(action, 'input:file');
					return false;
				});
				
			</script>

		</div>

	</body>
</html>
